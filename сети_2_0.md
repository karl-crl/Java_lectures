Что мб на летучке:
* **Как происходит передача данных через шлюз?**
Пришли данные на шлюз, что с ними делать?
1) Проверяем MAC адрес. Если это не адрес нашего шлюза, то выкидываем. 
2) Дальше проверяем IP. Если это IP шлюза, про был NAT, смотрим по таблице NAT шлюза, есть ли запись с парой (IP, port)
из пакета. Если есть то подменяем (IP, port).
3) Дальше надо понять, а на какой именно интерфейс из кучи нам передавать дальше пакет.
Для этого у каждого шлюза есть **таблица маршрутизации**.
Таблица маршрутизации позволяет понять, на какой физический интерфейс (физическая сетевая карта) нужно передавать пакет.
На обычном компьютере такая штука тоже нужна, т.к. на нем тоже несколько сетевых интерфейсов. Есть wifi,
проводной интернет, докер, который внутри компьютера организует локальную сеть и т.д.
Хотим отправить пакет на компьютер с известным IP. Как понять, на какой интерфейс его отправить?
* Пробегаем по интерфейсам в порядке возрастания/убывания (зависит от ОС) метрики.
* Ищем первую строчку, которая подойдет (первую пару IP-mask, в которую наш IP попадает)
4) Подменяем MAC адрес нашего шлюза на то устройство, которому будем передавать и передаем пакет.

* **Зачем нужен каждый из 4х уровней стека протоколов TCP/IP?**
1) Application --- пишем программу, хотим думать только про то, какие данные надо принять и получить, и не думать про
всякие IP, порты и физическую передачу данных.
2) Transport --- например, пишем программу, которая может слушать до 10к портов. Все происходит с одного компьютера,
поэтому не хотим думать про IP, нужно знать только какие данные на какой порт приходят.
3) Network --- нужен, чтобы иметь возможность делать маршрутизацию, работать с IP адресами.
4) Link --- отделяем уровень Link, т.к. можем хотеть, чтобы приложение не зависило от физического способа передачи
данных. Уровень Link будет разный в зависимости от способа передачи. Отделяем всю остальную информацию от физической
реализации передачи.
???(хотим писать шлюз, нужно знать MAC-адрес. Если не знаем его, то тогда если шлюз получает данные, понимает,
что его IP не совпадает с IP получаетеля, и выкидывает этот пакет нафиг.)

* **Что такое широковещательный пакет? Как его отправить?**
Когда устройство принимает пакет, оно проверяет, совпадает ли его МАС-адрес с МАС-адресом в пакете. Если нет, то оно его
выкидывает. Чтобы отправить пакет устройству, надо знать его МАС-адрес, т.е. спросить его у устройства.
Отправим специальный пакет с IP адресом того, чей МАС-адрес нужен. Это устройство нам ответит и мы узнаем его
МАС-адрес.
2) Чтобы отправить пакет, нужно знать МАС-адрес того, кому мы его отправляем. А мы его не знаем. Поэтому есть 
специальный широковещательный пакет.
МАС-адрес: FF:FF:FF:FF:FF:FF проставляется у такого пакета. Этот пакет предназначен всем.

* **Что такое DNS протокол, как оно работает**
**DNS**(Domain name service) --- протокол, нужен, чтобы узнавать IP адресс по доменному имени.

Биба хочет отправить данные на vk.com, но не знает IP. Для этого он отправляет запрос с доменным именем своему DNS.
Если DNS знает такое имя, то он отправляет Бибе IP, иначе спрашивает у вышестоящего DNS.

Так мы все идем выше по DNS и спрашиваем, пока либо не найдем vk.com, либо не дойдем до корневого DNS.

**Корневой DNS** не знает IP vk.com, но он знает, у кого спросить. Он знает, кто отвечает за `*.com`, а тот уже
знает, кто отвечает за `vk.com`, и вот оттуда мы уже получаем IP.

Вот это все называется **рекурсивный DNS запрос**.     
Недостаток: очень большая нагрузка на участников цепочки     
Плюс: каждый участник цепочки может закешировать себе ответ, и, например, когда Боба тоже пошлет запрос, DNS сразу
выдаст ему ответ из кэша.
Лучше при медленном соединении

Второй тип DNS запросов - **нерекурсивные**.    
Наш DNS спрашивает у вышестоящего про vk.com, тот отвечает "Не знаю, спроси у этого". Мы посылаем запрос другому DNS
и так продолжается, пока не найдем IP.     
Плюсы: Меньше нагрузка на все DNS     
Минусы: Больше нагрузка на наш DNS

Вопрос: кому принадлежат корневые DNS сервера?     
* Их около 12
* Они имеют имена A, B, C, D, E, ....
* На каждую часть света по 1 примерно (бывает больше)
* 50% и 1 акция принадлежат правительству США.

* **Типы DNS записей**
1) A - domain-name -> IPv4
2) AAAA - domain-name -> IPv6
3) CNAME - каноническое имя
4) NS - указывает на DNS сервер данного домена
5) PTR -> IP -> canonical name

* **Отличие TCP и UDP**
TCP "гарантирует доставку данных". Что конкретно под этим понимается:
1) Устанавливает соединение перед началом общения
2) Гарантирует, что пакеты будут доставлены в том порядке, в каком они посылались (нумерует пакеты при передаче)
3) После того, как мы отправили пакет, ждет сообщения о том, что пакет получен. Если не пришло сбщ, то в течении
еще какого-то времени пробуем повторно доставить пакет. Если не получилось, обрываем связь.

* **Что такое заголовок пакета? Что там находится? Зачем?**
Заголовок пакета - это всякая мета-информация о пакете
Что там есть?
1) Версия пакета (IPv4, IPv6)
2) IHL (указывает на начало блока данных)
3) Длина пакета 
4) Флаги - является ли этот пакет фрагментируемым, является ли последним в цепочке пакетов, что-то еще?
5) Смещения фрагмента - позиция фрагмента данных в потоке данных
6) TTL - время жизни пакета, количество маршрутизаторов, через которые пакет может пройти. Может случиться так, что
маршрутизаторы зациклились в какой-то круг и пакет будет без TTL бесконечно долго по этому кругу бегать. Чтобы он так
не делал, то у него есть TTL.
7) Контрольная сумма заголовка, чтобы проверять возможные ошибки
8) IP отправителя и получателя
9) Протокол (TCP, UDP, ...)

* **Зачем нужен протокол ICMP?**
ICMP отправляют маршрутизаторы, чтобы сообщить об ошибке при отправлении пакета. Используется в командах ping, trace,
так же можно с его помощью делать синхронизацию времени двух компов.

* **Что такое ARP?**
Resolution. Отвечает, какой мас-адрес соответствует данному IP. 

* **Зачем нужны корневые DNS сервера?**
Чтобы перенаправлять запросы на соотв. домены первого уровня.

* **Что такое порт? Как его выбрать?**
Порт - это чиселка из 0 до 65536. Он нужен, чтобы отправить данные нужному приложению, и чтобы несколько приложений
могли независимо принимать/отправлять данные.

Есть три варианта выбора порта:
1) Случайно
2) Порт 80 (соотв, протоколу http и обычно используется серверами)
3) Выбираем сами (обычно, когда пишем серверное приложение)

Вопросы:
* Что значит "передать напрямую"?


### IP
1. У каждого компьютера есть IP адрес.
2. IP адреса бывают разных стандартов: IPv4, IPv6

### Маска
* Что это?
Битовый вектор вида n*[1] ++ (N-n)*[0]. Т.е. первые n символов должны совпадать.
* Зачем?
Чтобы отличать компьютеры в локальной сети от компов в глобальной сети.
* Шлюз тоже находится в локальной сети.
